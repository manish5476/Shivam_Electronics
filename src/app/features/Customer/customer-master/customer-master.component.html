<!-- <section class="body-font " [ngClass]="{'dark-mode': isDarkMode}" [formGroup]="customerForm">
  <div pFocusTrap class="container px-5 py-1 mx-auto flex flex-wrap">
    <div class="flex w-full mb-8 flex-wrap justify-between items-center">
      <h1 class="sm:text-3xl text-2xl font-medium title-font text-gray-900 dark:text-white lg:mb-0 mb-4 text-center">
        Customer Profile</h1>
      <button pButton pRipple type="button" icon="pi pi-moon" class="p-button-rounded p-button-text"
        (click)="toggleDarkMode()" [ngClass]="{'p-button-outlined': !isDarkMode}" tooltip="Toggle Dark Mode"
        tooltipPosition="bottom"></button>
    </div>
    <div class="flex flex-wrap md:-m-2 -m-1 w-full">
      <div class="w-full md:w-1/3 p-2 mx-auto">
        <div class="rounded-lg p-4 flex flex-col h-full profile-card shadow-md">
          <div class="profile-image-container">
            <img *ngIf="customerForm.get('profileImg')?.value" [src]="customerForm.get('profileImg')?.value"
              alt="Profile Image" class="profile-image">
            <i *ngIf="!customerForm.get('profileImg')?.value" class="pi pi-user profile-icon"></i>
          </div>

          <button (click)="fileUploader.choose()" class="upload-button">
            <i class="pi pi-upload"></i> Upload
          </button>

          <p *ngIf="uploadStatus" class="upload-status">{{ uploadStatus }}</p>

          <div class="form-group">
            <label for="status" class="form-label">Status</label>
            <p-select id="status" [options]="statuses" formControlName="status" placeholder="Select Status"
              class="w-full md:w-56"></p-select>
          </div>

          <div class="form-group">
            <label for="guaranteer" class="form-label">Guaranteer Name</label>
            <p-select id="guaranteer" (onChange)="selectedGuaranterevent($event)" [options]="customerIDDropdown"
              optionLabel="fullname" [(ngModel)]="selectedGuaranter" placeholder="Select Guaranteer"
              class="w-full md:w-56"></p-select>
            <div id="guaranteer-name" placeholder="guaranter name" class="guaranteer-info">
              {{selectedGuaranter?.fullname}}</div>
            <div *ngFor="let item of selectedGuaranter?.phoneNumbers">
              <div id="guaranteer-phone" placeholder="guaranteer phone Number" class="guaranteer-info">{{item?.number}}
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-wrap w-full md:w-2/3 p-2">
        <div class="md:p-2 p-1 w-full">
          <div class="form-card">
            <p-card header="Personal Information" styleClass="form-card-content">
              <div class="grid grid-cols-2 gap-4">
                <div class="form-group">
                  <label for="fullname" class="form-label">Full Name</label>
                  <input id="fullname" type="text" pInputText class="form-input" formControlName="fullname" />
                  <small *ngIf="customerForm.controls['fullname'].invalid && customerForm.controls['fullname'].touched"
                    class="p-error block">Fullname is required</small>
                </div>
                <div class="form-group">
                  <label for="email" class="form-label">Email</label>
                  <input id="email" type="email" pInputText class="form-input" formControlName="email" />
                  <small *ngIf="customerForm.controls['email'].invalid && customerForm.controls['email'].touched"
                    class="p-error block">Invalid email format</small>

                </div>
              </div>
            </p-card>
          </div>

          <div class="mt-4 form-card">
            <p-card header="Phone Numbers" styleClass="form-card-content">
              <p-table [value]="phoneNumbersFormArray.controls" [paginator]="true" [rows]="3" styleClass="form-table">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Number</th>
                    <th>Type</th>
                    <th>Primary</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-phone let-i="index">
                  <tr [formGroupName]="i">
                    <td>{{ phone.value.number }}</td>
                    <td>{{ phone.value.type }}</td>
                    <td class="text-center"><p-checkbox formControlName="primary" binary="true"></p-checkbox></td>
                    <td class="actions-column">
                      <button pButton icon="pi pi-pencil"
                        class="action-button p-button-rounded p-button-text p-button-sm"
                        (click)="editPhone(i)"></button>
                      <button pButton icon="pi pi-trash"
                        class="action-button p-button-rounded p-button-text p-button-sm"
                        (click)="deletePhone(i)"></button>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
              <button pButton label="Add Phone Number" icon="pi pi-plus" (click)="showPhoneDialog()"
                styleClass="add-button"></button>
            </p-card>
          </div>
          <div class="mt-4 form-card">
            <p-card header="Addresses" styleClass="form-card-content">
              <p-table [value]="addressesFormArray.controls" [paginator]="true" [rows]="3" styleClass="form-table">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Street</th>
                    <th>City</th>
                    <th>State</th>
                    <th>ZIP Code</th>
                    <th>Country</th>
                    <th>Type</th>
                    <th>Default</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-address let-i="index">
                  <tr [formGroupName]="i">
                    <td>{{ address.value.street }}</td>
                    <td>{{ address.value.city }}</td>
                    <td>{{ address.value.state }}</td>
                    <td>{{ address.value.zipCode }}</td>
                    <td>{{ address.value.country }}</td>
                    <td>{{ address.value.type }}</td>
                    <td class="text-center"><p-checkbox formControlName="isDefault" binary="true"></p-checkbox></td>
                    <td class="actions-column">
                      <button pButton icon="pi pi-pencil"
                        class="action-button p-button-rounded p-button-text p-button-sm"></button>
                      <button pButton icon="pi pi-trash"
                        class="action-button p-button-rounded p-button-text p-button-sm"
                        (click)="removeAddress(i)"></button>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
              <button pButton label="Add Address" styleClass="add-button" (click)="showAddressDialog()"></button>
            </p-card>
          </div>

        </div>
      </div>

      <div *ngIf="false" class="flex flex-wrap w-full md:w-full p-2">
        <div class="md:p-2 p-1 w-full">
          <div class="form-card">
            <div class="mx-auto max-w-screen-xl px-4 py-8 sm:px-6 sm:py-12 lg:px-8 rounded-lg">
              <div class="mx-auto max-w-3xl text-center">
                <h2 class="section-title">
                  Financial Status
                </h2>
              </div>

              <dl class="mt-6 grid grid-cols-2 gap-4 sm:mt-8 sm:grid-cols-2 lg:grid-cols-4">
                <div class="financial-stats">
                  <dt class="stats-label">Remaining Amount</dt>
                  <dd class="stats-value">{{ customer.remainingAmount | currency }}</dd>
                </div>

                <div class="financial-stats">
                  <dt class="stats-label">
                    Purchased Amount
                  </dt>
                  <dd class="stats-value">{{ customer.totalPurchasedAmount | currency }}</dd>
                </div>

                <div class="financial-stats">
                  <dt class="stats-label">Total BUY</dt>
                  <dd class="stats-value">86</dd>
                </div>

                <div class="financial-stats">
                  <dt class="stats-label">Downloads</dt>
                  <dd class="stats-value">86k</dd>
                </div>
              </dl>
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-wrap w-full p-2">
        <div class="md:p-2 p-1 w-full">
          <button (click)="saveCustomer()" class="save-button">Save Customer</button>
        </div>
      </div>
    </div>
  </div>
</section>

<p-dialog header="Add Phone Number" [(visible)]="phoneDialogVisible" styleClass="dialog-compact" [modal]="true"
  [closable]="true" [dismissableMask]="true" [breakpoints]="{'960px': '50vw', '640px': '90vw'}">
  <form [formGroup]="newPhoneNumberForm" (ngSubmit)="addPhoneNumber()">
    <div class="p-fluid">
      <div class="p-field mb-3">
        <label for="phoneNumber" class="form-label">Phone Number</label>
        <input id="phoneNumber" type="tel" pInputText formControlName="number" required class="form-input"
          placeholder="Enter phone number" />
        <small *ngIf="newPhoneNumberForm.controls['number'].invalid && newPhoneNumberForm.controls['number'].touched"
          class="p-error block">Phone Number is required</small>
      </div>

      <div class="p-field mb-3">
        <label for="phoneType" class="form-label">Phone Type</label>
        <p-select id="phoneType" [options]="phoneTypes" formControlName="type" optionLabel="label" optionValue="value"
          required class="w-full md:w-56">
        </p-select>
        <small *ngIf="newPhoneNumberForm.controls['type'].invalid && newPhoneNumberForm.controls['type'].touched"
          class="p-error block">Phone Type is required</small>
      </div>
      <div class="p-field flex items-center">
        <p-checkbox formControlName="primary" inputId="primaryPhone" binary="true" class="mr-2"></p-checkbox>
        <label for="primaryPhone" class="dialog-checkbox-label">Set as Primary Number</label>
      </div>
      <div class="flex justify-end gap-2 mt-4">
        <p-button label="Cancel" icon="pi pi-times" (click)="phoneDialogVisible = false"
          styleClass="p-button-text dialog-button-cancel" type="button"></p-button>
        <p-button label="Add Number" icon="pi pi-check" styleClass="dialog-button-add" type="submit"
          [disabled]="newPhoneNumberForm.invalid"></p-button>
      </div>
    </div>
  </form>
</p-dialog>

<p-fileUpload hidden #fileUploader name="image" url="http://localhost:4000/api/customers/{{customerId}}/profile-image"
  accept="image/*" maxFileSize="5000000" (onSelect)="handleFileSelect($event)" (onUpload)="handleFileUpload($event)"
  [auto]="true" [showUploadButton]="false" [showCancelButton]="false">
</p-fileUpload>

<p-dialog header="Add Address" [(visible)]="addressDialogVisible" styleClass="dialog-compact" [modal]="true"
  [closable]="true" [dismissableMask]="true" [breakpoints]="{'960px': '75vw', '640px': '90vw'}">
  <form [formGroup]="newAddressForm" (ngSubmit)="addAddress()">
    <div class="p-fluid">
      <div class="p-field mb-3">
        <label for="street" class="form-label">Street</label>
        <input id="street" type="text" pInputText formControlName="street" required class="form-input" />
        <small *ngIf="newAddressForm.controls['street'].invalid && newAddressForm.controls['street'].touched"
          class="p-error block">Street is required</small>

      </div>

      <div class="grid grid-cols-2 gap-4">
        <div class="p-field">
          <label for="city" class="form-label">City</label>
          <input id="city" type="text" pInputText formControlName="city" required class="form-input" />
          <small *ngIf="newAddressForm.controls['city'].invalid && newAddressForm.controls['city'].touched"
            class="p-error block">City is required</small>

        </div>

        <div class="p-field">
          <label for="state" class="form-label">State</label>
          <input id="state" type="text" pInputText formControlName="state" required class="form-input" />
          <small *ngIf="newAddressForm.controls['state'].invalid && newAddressForm.controls['state'].touched"
            class="p-error block">State is required</small>

        </div>
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div class="p-field">
          <label for="zipCode" class="form-label">ZIP Code</label>
          <input id="zipCode" type="text" pInputText formControlName="zipCode" required class="form-input" />
          <small *ngIf="newAddressForm.controls['zipCode'].invalid && newAddressForm.controls['zipCode'].touched"
            class="p-error block">ZIP Code is required</small>

        </div>

        <div class="p-field">
          <label for="country" class="form-label">Country</label>
          <input id="country" type="text" pInputText formControlName="country" required class="form-input" />
          <small *ngIf="newAddressForm.controls['country'].invalid && newAddressForm.controls['country'].touched"
            class="p-error block">Country is required</small>
        </div>
      </div>

      <div class="p-field mb-3">
        <label for="addressType" class="form-label">Address Type</label>
        <p-select id="addressType" [options]="addressTypes" formControlName="type" optionLabel="label"
          optionValue="value" required class="w-full md:w-56"></p-select>
        <small *ngIf="newAddressForm.controls['type'].invalid && newAddressForm.controls['type'].touched"
          class="p-error block">Address Type is required</small>

      </div>

      <div class="p-field flex items-center">
        <p-checkbox formControlName="isDefault" inputId="defaultAddress" binary="true" class="mr-2"></p-checkbox>
        <label for="defaultAddress" class="dialog-checkbox-label">Set as Default Address</label>
      </div>

      <div class="flex justify-end gap-2 mt-4">
        <p-button label="Cancel" icon="pi pi-times" (click)="addressDialogVisible = false"
          styleClass="p-button-text dialog-button-cancel" type="button"></p-button>
        <p-button label="Add Address" icon="pi pi-check" styleClass="dialog-button-add" type="submit"
          [disabled]="newAddressForm.invalid"></p-button>
      </div>
    </div>
  </form>
</p-dialog> -->





<section class="text-gray-400 bg-gray-900 body-font p-4">
  <div class="container px-5 py-12 mx-auto flex flex-wrap">
    <div class="flex w-full mb-8 flex-wrap justify-center">
      <h1 class="sm:text-3xl text-2xl font-medium title-font text-white lg:mb-0 mb-4 text-center">Customer Profile</h1>
    </div>
    <div class="flex flex-wrap md:-m-2 -m-1 w-full">
      <div class="w-full md:w-1/3 p-2 mx-auto">
        <div class="bg-gray-800 rounded-lg p-4 flex flex-col h-full border border-gray-700 shadow-lg">
          <div
            class="w-32 h-32 border-2 border-gray-600 rounded-lg flex items-center justify-center overflow-hidden mb-4 bg-gray-900 mx-auto">
            <img *ngIf="customer.profileImg" [src]="customer.profileImg" alt="Profile Image"
              class="w-full h-full object-cover">
            <i *ngIf="!customer.profileImg" class="pi pi-user text-gray-500 text-6xl"></i>
          </div>

          <button (click)="fileUploader.choose()"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded-md flex items-center gap-2 mx-auto justify-center">
            <i class="pi pi-upload"></i> Upload
          </button>

          <p *ngIf="uploadStatus" class="mt-2 text-sm text-green-500 text-center">{{ uploadStatus }}</p>

          <div class="mt-4">
            <label for="status" class="block text-sm font-medium text-gray-300 mb-1">Status</label>
            <p-select id="status" [options]="statuses" [(ngModel)]="customer.status"
              class="w-full border border-gray-600 rounded-md p-2 bg-gray-800 text-white"></p-select>
          </div>

          <div class="mt-4 flex flex-col space-y-2">
            <label for="guaranteer" class="block text-sm font-medium text-gray-300 mb-1">Guaranteer Name</label>
            <p-select id="guaranteer" (onChange)="selectedGuaranterevent($event)" [options]="customerIDDropdown"
              optionLabel="fullname" [(ngModel)]="selectedGuaranter"
              class="w-full border border-gray-600 rounded-md p-2 bg-gray-800 text-white"></p-select>

            <!-- <p-select (onClick)="selectedGuaranterevent($event)" optionLabel="fullname" [(ngModel)]="selectedGuaranter"
              class=" border border-gray-600 rounded-md p-2 bg-gray-800 text-white"></p-select> -->
            <div id="guaranteer" type="text" class="w-full border border-gray-600 rounded-md p-2 bg-gray-800 text-white"
              autocomplete="off">{{selectedGuaranter.fullname}}</div>
            <div *ngFor="let item of selectedGuaranter.phoneNumbers">
              <div id="guaranteer" type="text"
                class="w-full border border-gray-600 rounded-md p-2 bg-gray-800 text-white" autocomplete="off">
                {{item.number}}</div>
            </div>
          </div>

          <!-- <div class="mt-4">
            <label for="guaranteer" class="block text-sm font-medium text-gray-300 mb-1">Guaranteer Name</label>
            <p-select [options]="this.customerIDDropdown" [(ngModel)]="selectedGuaranter"
              class="w-full border border-gray-600 rounded-md p-2 bg-gray-800 text-white"></p-select>
            <p id="guaranteer" type="text" class="w-full border border-gray-600 rounded-md p-2 bg-gray-800 text-white"
              [(ngModel)]="selectedGuaranter.fullname" autocomplete="off">
            <p id="guaranteer" type="text" class="w-full border border-gray-600 rounded-md p-2 bg-gray-800 text-white"
              [(ngModel)]="selectedGuaranter.phoneNumbers[0].number" autocomplete="off">

          </div> -->
        </div>
      </div>
      <div class="flex flex-wrap w-full md:w-2/3 p-2">
        <div class="md:p-2 p-1 w-full">
          Name & Email Card
          <div class="bg-gray-900 p-4 rounded-lg shadow-md border border-gray-700">
            <p-card header="Personal Information" class="bg-gray-900 text-white">
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label for="fullname" class="block text-sm font-medium text-gray-300">Full Name</label>
                  <input id="fullname" type="text"
                    class="p-inputtext w-full bg-gray-800 text-white border border-gray-600 rounded-md p-2"
                    [(ngModel)]="customer.fullname" required />
                </div>
                <div>
                  <label for="email" class="block text-sm font-medium text-gray-300">Email</label>
                  <input id="email" type="email"
                    class="p-inputtext w-full bg-gray-800 text-white border border-gray-600 rounded-md p-2"
                    [(ngModel)]="customer.email" required />
                </div>
              </div>
            </p-card>
          </div>

          Phone Numbers Card
          <!-- <div class="mt-4 bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700">
            <p-card header="Phone Numbers" class="bg-gray-900 text-white">
              <p-table [value]="customer.phoneNumbers" [paginator]="true" [rows]="3"
                class="mt-4 bg-gray-900 text-white">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Number</th>
                    <th>Type</th>
                    <th>Primary</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-phone let-i="index">
                  <tr>
                    <td>{{ phone.number }}</td>
                    <td>{{ phone.type }}</td>
                    <td><p-tableCheckbox [(ngModel)]="phone.primary" /></td>
                    <td>
                      <button pButton (click)="editPhone(i)" icon="pi pi-pencil"
                        class="p-button-rounded p-button-text p-button-sm"></button>
                      <button pButton icon="pi pi-trash" class="p-button-rounded p-button-text p-button-sm"
                        (click)="deletePhone(i)"></button>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
              <button pButton label="Add Phone Number" icon="pi pi-plus" (click)="showPhoneDialog()"
                class="mt-2 p-button-sm bg-blue-600 hover:bg-blue-700"></button>
            </p-card>
          </div>
          Addresses Card
          <div class="mt-4 bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700">
            <p-card header="Addresses" class="bg-gray-900 text-white">
              <p-table [value]="customer.addresses" [paginator]="true" [rows]="3" class="mt-4 bg-gray-900 text-white">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Street</th>
                    <th>City</th>
                    <th>State</th>
                    <th>ZIP Code</th>
                    <th>Country</th>
                    <th>Type</th>
                    <th>Default</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-address let-i="index">
                  <tr>
                    <td>{{ address.street }}</td>
                    <td>{{ address.city }}</td>
                    <td>{{ address.state }}</td>
                    <td>{{ address.zipCode }}</td>
                    <td>{{ address.country }}</td>
                    <td>{{ address.type }}</td>
                    <td><p-tableCheckbox [(ngModel)]="address.isDefault" /></td>
                    <td>
                      <button pButton (click)="editAddress(i)" icon="pi pi-pencil"
                        class="p-button-rounded p-button-text p-button-sm"></button>
                      <button pButton icon="pi pi-trash" class="p-button-rounded p-button-text p-button-sm"
                        (click)="removeAddress(i)"></button>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
              <button class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 mt-2"
                (click)="addAddress()">Add Address</button>
            </p-card>
          </div> -->
          <div class="mt-4 bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700">
                        <p-card header="Phone Numbers" class="bg-gray-900 text-white">
                            <p-table [value]="customer.phoneNumbers" [paginator]="true" [rows]="3"                
                class="mt-4 bg-gray-900 text-white">
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th>Number</th>
                                        <th>Type</th>
                                        <th>Primary</th>
                                        <th>Actions</th>
                                      </tr>
                                  </ng-template>
                                <ng-template pTemplate="body" let-phone let-i="index">
                                    <tr>
                                        <td>{{ phone.number }}</td>
                                        <td>{{ phone.type }}</td>
                                        <td><p-tableCheckbox [(ngModel)]="phone.primary" /></td>
                                        <td>
                                            <button pButton (click)="editPhone(i)" icon="pi pi-pencil"                  
                              class="p-button-rounded p-button-text p-button-sm"></button>
                                            <button pButton icon="pi pi-trash"
                        class="p-button-rounded p-button-text p-button-sm"                        
                        (click)="deletePhone(i)"></button>
                                          </td>
                                      </tr>
                                  </ng-template>
                              </p-table>
                            <button pButton label="Add Phone Number" icon="pi pi-plus" (click)="showPhoneDialog()"      
                          class="mt-2 p-button-sm bg-blue-600 hover:bg-blue-700"></button>
                          </p-card>
                      </div>
                    Addresses Card
                    <div class="mt-4 bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700">
                        <p-card header="Addresses" class="bg-gray-900 text-white">
                            <p-table [value]="customer.addresses" [paginator]="true" [rows]="3"
                class="mt-4 bg-gray-900 text-white">
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th>Street</th>
                                        <th>City</th>
                                        <th>State</th>
                                        <th>ZIP Code</th>
                                        <th>Country</th>
                                        <th>Type</th>
                                        <th>Default</th>
                                        <th>Actions</th>
                                      </tr>
                                  </ng-template>
                                <ng-template pTemplate="body" let-address let-i="index">
                                    <tr>
                                        <td>{{ address.street }}</td>
                                        <td>{{ address.city }}</td>
                                        <td>{{ address.state }}</td>
                                        <td>{{ address.zipCode }}</td>
                                        <td>{{ address.country }}</td>
                                        <td>{{ address.type }}</td>
                                        <td><p-tableCheckbox [(ngModel)]="address.isDefault" /></td>
                                        <td>
                                            <button pButton (click)="editAddress(i)" icon="pi pi-pencil"                
                                class="p-button-rounded p-button-text p-button-sm"></button>
                                            <button pButton icon="pi pi-trash"
                        class="p-button-rounded p-button-text p-button-sm"                        
                        (click)="removeAddress(i)"></button>
                                          </td>
                                      </tr>
                                  </ng-template>
                              </p-table>
                            <button class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 mt-2"          
                      (click)="showAddressDialog()">Add Address</button>
                          </p-card>
                      </div>

        </div>
      </div>

      <div *ngIf="false" class="flex flex-wrap w-full md:w-full p-2">
        <div class="md:p-2 p-1 w-full">
          <div class="bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700">
            <div class="mx-auto max-w-screen-xl px-4 py-8 sm:px-6 sm:py-12 lg:px-8 bg-gray-900 rounded-lg">
              <div class="mx-auto max-w-3xl text-center">
                <h2 class="text-3xl font-bold text-yellow-500 sm:text-4xl">
                  Financial Status
                </h2>
              </div>

              <dl class="mt-6 grid grid-cols-2 gap-4 sm:mt-8 sm:grid-cols-2 lg:grid-cols-4">
                <div class="flex flex-col rounded-lg border border-gray-600 px-4 py-8 text-center bg-gray-900">
                  <dt class="order-last text-lg font-medium text-gray-400">Remaining Amount</dt>
                  <dd class="text-4xl font-extrabold text-blue-500 md:text-5xl">{{ customer.remainingAmount | currency
                    }}</dd>
                </div>

                <div class="flex flex-col rounded-lg border border-gray-600 px-4 py-8 text-center bg-gray-900">
                  <dt class="order-last text-lg font-medium text-gray-400">
                    Purchased Amount
                  </dt>
                  <dd class="text-4xl font-extrabold text-blue-500 md:text-5xl">{{ customer.totalPurchasedAmount |
                    currency }}</dd>
                </div>

                <div class="flex flex-col rounded-lg border border-gray-600 px-4 py-8 text-center bg-gray-900">
                  <dt class="order-last text-lg font-medium text-gray-400">Total BUY</dt>
                  <dd class="text-4xl font-extrabold text-blue-500 md:text-5xl">86</dd>
                </div>

                <div class="flex flex-col rounded-lg border border-gray-600 px-4 py-8 text-center bg-gray-900">
                  <dt class="order-last text-lg font-medium text-gray-400">Downloads</dt>
                  <dd class="text-4xl font-extrabold text-blue-500 md:text-5xl">86k</dd>
                </div>
              </dl>
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-wrap w-full p-2">
        <div class="md:p-2 p-1 w-full">
          <button (click)="saveCustomer()"
            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md font-semibold w-full">Save
            Customer</button>
        </div>
      </div>
    </div>

    <p-dialog header="Add Phone Number" [(visible)]="phoneDialogVisible"
      styleClass="p-dialog-compact bg-gray-800 text-white border border-gray-700 rounded-lg p-5 shadow-lg"
      [modal]="true" [closable]="true" [dismissableMask]="true" [breakpoints]="{'960px': '50vw', '640px': '90vw'}">
      <div class="p-fluid">
        <div class="p-field mb-3">
          <label for="phoneNumber" class="block text-sm font-medium text-gray-300 mb-1">Phone Number</label>
          <input id="phoneNumber" type="tel" pInputText [(ngModel)]="newPhoneNumber.number" required
            class="p-inputtext w-full bg-gray-900 text-white border border-gray-600 rounded-md p-2 focus:ring-2 focus:ring-blue-500"
            placeholder="Enter phone number" />
        </div>

        <div class="p-field mb-3">
          <label for="phoneType" class="block text-sm font-medium text-gray-300 mb-1">Phone Type</label>
          <p-select id="phoneType" [options]="phoneTypes" [(ngModel)]="newPhoneNumber.type" optionLabel="label"
            optionValue="value" required
            class="p-select w-full bg-gray-900 text-white border border-gray-600 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
          </p-select>
        </div>

        <div class="p-field flex items-center">
          <p-checkbox [(ngModel)]="newPhoneNumber.primary" inputId="primaryPhone" binary="true"
            class="mr-2"></p-checkbox>
          <label for="primaryPhone" class="text-sm text-gray-300">Set as Primary Number</label>
        </div>

        <div class="flex justify-end gap-2 mt-4">
          <p-button label="Cancel" icon="pi pi-times" (click)="phoneDialogVisible = false"
            class="p-button-text text-gray-400 hover:text-white"></p-button>
          <p-button label="Add Number" icon="pi pi-check" (click)="addPhoneNumber()"
            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-semibold"></p-button>
        </div>
      </div>
    </p-dialog>

    <p-fileUpload hidden #fileUploader name="image"
      url="http://localhost:4000/api/customers/{{customerId}}/profile-image" accept="image/*" maxFileSize="5000000"
      (onSelect)="handleFileSelect($event)" (onUpload)="handleFileUpload($event)" [auto]="true"
      [showUploadButton]="false" [showCancelButton]="false">
    </p-fileUpload>

    <p-dialog header="Add Address" [(visible)]="addressDialogVisible"
      styleClass="p-dialog-compact bg-gray-800 text-white border border-gray-700 rounded-lg p-5 shadow-lg"
      [modal]="true" [closable]="true" [dismissableMask]="true" [breakpoints]="{'960px': '75vw', '640px': '90vw'}">
      <div class="p-fluid">
        <div class="p-field mb-3">
          <label for="street" class="block text-sm font-medium text-gray-300 mb-1">Street</label>
          <input id="street" type="text" pInputText [(ngModel)]="newAddress.street" required
            class="p-inputtext w-full bg-gray-900 text-white border border-gray-600 rounded-md p-2" />
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div class="p-field">
            <label for="city" class="block text-sm font-medium text-gray-300 mb-1">City</label>
            <input id="city" type="text" pInputText [(ngModel)]="newAddress.city" required
              class="p-inputtext w-full bg-gray-900 text-white border border-gray-600 rounded-md p-2" />
          </div>

          <div class="p-field">
            <label for="state" class="block text-sm font-medium text-gray-300 mb-1">State</label>
            <input id="state" type="text" pInputText [(ngModel)]="newAddress.state" required
              class="p-inputtext w-full bg-gray-900 text-white border border-gray-600 rounded-md p-2" />
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div class="p-field">
            <label for="zipCode" class="block text-sm font-medium text-gray-300 mb-1">ZIP Code</label>
            <input id="zipCode" type="text" pInputText [(ngModel)]="newAddress.zipCode" required
              class="p-inputtext w-full bg-gray-900 text-white border border-gray-600 rounded-md p-2" />
          </div>

          <div class="p-field">
            <label for="country" class="block text-sm font-medium text-gray-300 mb-1">Country</label>
            <input id="country" type="text" pInputText [(ngModel)]="newAddress.country" required
              class="p-inputtext w-full bg-gray-900 text-white border border-gray-600 rounded-md p-2" />
          </div>
        </div>

        <div class="p-field mb-3">
          <label for="addressType" class="block text-sm font-medium text-gray-300 mb-1">Address Type</label>
          <p-select id="addressType" [options]="addressTypes" [(ngModel)]="newAddress.type" optionLabel="label"
            optionValue="value" required
            class="p-select w-full bg-gray-900 text-white border border-gray-600 rounded-md p-2"></p-select>
        </div>

        <div class="p-field flex items-center">
          <p-checkbox [(ngModel)]="newAddress.isDefault" inputId="defaultAddress" binary="true"
            class="mr-2"></p-checkbox>
          <label for="defaultAddress" class="text-sm text-gray-300">Set as Default Address</label>
        </div>

        <div class="flex justify-end gap-2 mt-4">
          <p-button label="Cancel" icon="pi pi-times" (click)="addressDialogVisible = false"
            class="p-button-text text-gray-400 hover:text-white"></p-button>
          <p-button label="Add Address" icon="pi pi-check" (click)="addAddress()"
            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-semibold"></p-button>
        </div>
      </div>
    </p-dialog>
  </div>
</section>
<!-- <section class="body-font " [ngClass]="{'dark-mode': isDarkMode}">
  <div pFocusTrap class="container px-5 py-1 mx-auto flex flex-wrap">
    <div class="flex w-full mb-8 flex-wrap justify-between items-center">
      <h1 class="sm:text-3xl text-2xl font-medium title-font text-gray-900 dark:text-white lg:mb-0 mb-4 text-center">
        Customer Profile</h1>
      <button pButton pRipple type="button" icon="pi pi-moon" class="p-button-rounded p-button-text"
        (click)="toggleDarkMode()" [ngClass]="{'p-button-outlined': !isDarkMode}" tooltip="Toggle Dark Mode"
        tooltipPosition="bottom"></button>
    </div>
    <div class="flex flex-wrap md:-m-2 -m-1 w-full">
      <div class="w-full md:w-1/3 p-2 mx-auto">
        <div class="rounded-lg p-4 flex flex-col h-full profile-card shadow-md">
          <div class="profile-image-container">
            <img *ngIf="customer.profileImg" [src]="customer.profileImg" alt="Profile Image" class="profile-image">
            <i *ngIf="!customer.profileImg" class="pi pi-user profile-icon"></i>
          </div>

          <button (click)="fileUploader.choose()" class="upload-button">
            <i class="pi pi-upload"></i> Upload
          </button>

          <p *ngIf="uploadStatus" class="upload-status">{{ uploadStatus }}</p>

          <div class="form-group">
            <label for="status" class="form-label">Status</label>
            <p-select id="status" [options]="statuses" [(ngModel)]="customer.status" placeholder="Select Status"
              class="w-full md:w-56"></p-select>
          </div>

          <div class="form-group">
            <label for="guaranteer" class="form-label">Guaranteer Name</label>
            <p-select id="guaranteer" (onChange)="selectedGuaranterevent($event)" [options]="customerIDDropdown"
              optionLabel="fullname" [(ngModel)]="selectedGuaranter" placeholder="Select Guaranteer"
              class="w-full md:w-56"></p-select>
            <div id="guaranteer-name" placeholder="guaranter name" class="guaranteer-info">
              {{selectedGuaranter?.fullname}}</div>
            <div *ngFor="let item of selectedGuaranter?.phoneNumbers">
              <div id="guaranteer-phone" placeholder="guaranteer phone Number" class="guaranteer-info">{{item?.number}}
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-wrap w-full md:w-2/3 p-2">
        <div class="md:p-2 p-1 w-full">
          <div class="form-card">
            <p-card header="Personal Information" styleClass="form-card-content">
              <div class="grid grid-cols-2 gap-4">
                <div class="form-group">
                  <label for="fullname" class="form-label">Full Name</label>
                  <input id="fullname" type="text" pInputText class="form-input" [(ngModel)]="customer.fullname"
                    required />
                </div>
                <div class="form-group">
                  <label for="email" class="form-label">Email</label>
                  <input id="email" type="email" pInputText class="form-input" [(ngModel)]="customer.email" required />
                </div>
              </div>
            </p-card>
          </div>

          <div class="mt-4 form-card">
            <p-card header="Phone Numbers" styleClass="form-card-content">
              <p-table [value]="customer.phoneNumbers" [paginator]="true" [rows]="3" styleClass="form-table">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Number</th>
                    <th>Type</th>
                    <th>Primary</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-phone let-i="index">
                  <tr>
                    <td>{{ phone.number }}</td>
                    <td>{{ phone.type }}</td>
                    <td class="text-center"><p-checkbox [(ngModel)]="phone.primary" binary="true"></p-checkbox></td>
                    <td class="actions-column">
                      <button pButton icon="pi pi-pencil"
                        class="action-button p-button-rounded p-button-text p-button-sm"></button>
                      <button pButton icon="pi pi-trash"
                        class="action-button p-button-rounded p-button-text p-button-sm"
                        (click)="deletePhone(i)"></button>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
              <button pButton label="Add Phone Number" icon="pi pi-plus" (click)="showPhoneDialog()"
                styleClass="add-button"></button>
            </p-card>
          </div>
          <div class="mt-4 form-card">
            <p-card header="Addresses" styleClass="form-card-content">
              <p-table [value]="customer.addresses" [paginator]="true" [rows]="3" styleClass="form-table">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Street</th>
                    <th>City</th>
                    <th>State</th>
                    <th>ZIP Code</th>
                    <th>Country</th>
                    <th>Type</th>
                    <th>Default</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-address let-i="index">
                  <tr>
                    <td>{{ address.street }}</td>
                    <td>{{ address.city }}</td>
                    <td>{{ address.state }}</td>
                    <td>{{ address.zipCode }}</td>
                    <td>{{ address.country }}</td>
                    <td>{{ address.type }}</td>
                    <td class="text-center"><p-checkbox [(ngModel)]="address.isDefault" binary="true"></p-checkbox></td>
                    <td class="actions-column">
                      <button pButton icon="pi pi-pencil"
                        class="action-button p-button-rounded p-button-text p-button-sm"></button>
                      <button pButton icon="pi pi-trash"
                        class="action-button p-button-rounded p-button-text p-button-sm"
                        (click)="removeAddress(i)"></button>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
              <button pButton label="Add Address" styleClass="add-button" (click)="showAddressDialog()"></button>
            </p-card>
          </div>

        </div>
      </div>

      <div *ngIf="false" class="flex flex-wrap w-full md:w-full p-2">
        <div class="md:p-2 p-1 w-full">
          <div class="form-card">
            <div class="mx-auto max-w-screen-xl px-4 py-8 sm:px-6 sm:py-12 lg:px-8 rounded-lg">
              <div class="mx-auto max-w-3xl text-center">
                <h2 class="section-title">
                  Financial Status
                </h2>
              </div>

              <dl class="mt-6 grid grid-cols-2 gap-4 sm:mt-8 sm:grid-cols-2 lg:grid-cols-4">
                <div class="financial-stats">
                  <dt class="stats-label">Remaining Amount</dt>
                  <dd class="stats-value">{{ customer.remainingAmount | currency }}</dd>
                </div>

                <div class="financial-stats">
                  <dt class="stats-label">
                    Purchased Amount
                  </dt>
                  <dd class="stats-value">{{ customer.totalPurchasedAmount | currency }}</dd>
                </div>

                <div class="financial-stats">
                  <dt class="stats-label">Total BUY</dt>
                  <dd class="stats-value">86</dd>
                </div>

                <div class="financial-stats">
                  <dt class="stats-label">Downloads</dt>
                  <dd class="stats-value">86k</dd>
                </div>
              </dl>
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-wrap w-full p-2">
        <div class="md:p-2 p-1 w-full">
          <button (click)="saveCustomer()" class="save-button">Save Customer</button>
        </div>
      </div>
    </div>
  </div>
</section>

<p-dialog header="Add Phone Number" [(visible)]="phoneDialogVisible" styleClass="dialog-compact" [modal]="true"
  [closable]="true" [dismissableMask]="true" [breakpoints]="{'960px': '50vw', '640px': '90vw'}">
  <div class="p-fluid">
    <div class="p-field mb-3">
      <label for="phoneNumber" class="form-label">Phone Number</label>
      <input id="phoneNumber" type="tel" pInputText [(ngModel)]="newPhoneNumber.number" required class="form-input"
        placeholder="Enter phone number" />
    </div>

    <div class="p-field mb-3">
      <label for="phoneType" class="form-label">Phone Type</label>
      <p-select id="phoneType" [options]="phoneTypes" [(ngModel)]="newPhoneNumber.type" optionLabel="label"
        optionValue="value" required class="w-full md:w-56">
      </p-select>
    </div>

    <div class="p-field flex items-center">
      <p-checkbox [(ngModel)]="newPhoneNumber.primary" inputId="primaryPhone" binary="true" class="mr-2"></p-checkbox>
      <label for="primaryPhone" class="dialog-checkbox-label">Set as Primary Number</label>
    </div>

    <div class="flex justify-end gap-2 mt-4">
      <p-button label="Cancel" icon="pi pi-times" (click)="phoneDialogVisible = false"
        styleClass="p-button-text dialog-button-cancel"></p-button>
      <p-button label="Add Number" icon="pi pi-check" (click)="addPhoneNumber()"
        styleClass="dialog-button-add"></p-button>
    </div>
  </div>
</p-dialog>

<p-fileUpload hidden #fileUploader name="image" url="http://localhost:4000/api/customers/{{customerId}}/profile-image"
  accept="image/*" maxFileSize="5000000" (onSelect)="handleFileSelect($event)" (onUpload)="handleFileUpload($event)"
  [auto]="true" [showUploadButton]="false" [showCancelButton]="false">
</p-fileUpload>

<p-dialog header="Add Address" [(visible)]="addressDialogVisible" styleClass="dialog-compact" [modal]="true"
  [closable]="true" [dismissableMask]="true" [breakpoints]="{'960px': '75vw', '640px': '90vw'}">
  <div class="p-fluid">
    <div class="p-field mb-3">
      <label for="street" class="form-label">Street</label>
      <input id="street" type="text" pInputText [(ngModel)]="newAddress.street" required class="form-input" />
    </div>

    <div class="grid grid-cols-2 gap-4">
      <div class="p-field">
        <label for="city" class="form-label">City</label>
        <input id="city" type="text" pInputText [(ngModel)]="newAddress.city" required class="form-input" />
      </div>

      <div class="p-field">
        <label for="state" class="form-label">State</label>
        <input id="state" type="text" pInputText [(ngModel)]="newAddress.state" required class="form-input" />
      </div>
    </div>

    <div class="grid grid-cols-2 gap-4">
      <div class="p-field">
        <label for="zipCode" class="form-label">ZIP Code</label>
        <input id="zipCode" type="text" pInputText [(ngModel)]="newAddress.zipCode" required class="form-input" />
      </div>

      <div class="p-field">
        <label for="country" class="form-label">Country</label>
        <input id="country" type="text" pInputText [(ngModel)]="newAddress.country" required class="form-input" />
      </div>
    </div>

    <div class="p-field mb-3">
      <label for="addressType" class="form-label">Address Type</label>
      <p-select id="addressType" [options]="addressTypes" [(ngModel)]="newAddress.type" optionLabel="label"
        optionValue="value" required class="w-full md:w-56"></p-select>
    </div>

    <div class="p-field flex items-center">
      <p-checkbox [(ngModel)]="newAddress.isDefault" inputId="defaultAddress" binary="true" class="mr-2"></p-checkbox>
      <label for="defaultAddress" class="dialog-checkbox-label">Set as Default Address</label>
    </div>

    <div class="flex justify-end gap-2 mt-4">
      <p-button label="Cancel" icon="pi pi-times" (click)="addressDialogVisible = false"
        styleClass="p-button-text dialog-button-cancel"></p-button>
      <p-button label="Add Address" icon="pi pi-check" (click)="addAddress()" styleClass="dialog-button-add"></p-button>
    </div>
  </div>
</p-dialog> -->
<!-- </section> -->